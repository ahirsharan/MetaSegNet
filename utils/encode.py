import numpy as np

#RGB Values (modified for COCO and FSS)
VOC_COLORMAP = [[0, 0, 0], [128, 0, 0], [0, 128, 0], [128, 128, 0],
                [0, 0, 128], [128, 0, 128], [0, 128, 128], [128, 128, 128],
                [64, 0, 0], [192, 0, 0], [64, 128, 0], 
                [0, 64, 0], [128, 64, 0], [0, 192, 0], [128, 192, 0],
                [0, 64, 128], [192, 128, 0],
                [64, 0, 128], [192, 0, 128], [64, 128, 128], [192, 128, 128],
                [0, 64, 0], [128, 64, 0], [0, 192, 0], [128, 192, 0], [0, 64, 128],
                [0 ,0 ,192],[0,0,64],[64,64,128],[64,64,64],[192,192,192],[64,64,0],[154, 130, 104], [183, 215, 162], [140, 78, 40], [253, 241, 184], [119, 22, 132], [229, 72, 98], [212, 152, 163], [94, 98, 220], [88, 35, 234], [192, 142, 255], [143, 91, 175], [146, 51, 163], [147, 229, 73], [22, 80, 236], [234, 217, 8], [47, 20, 189], [23, 229, 48], [73, 114, 75], [125, 121, 15], [40, 205, 188], [143, 85, 204], [221, 248, 242], [154, 162, 149], [54, 213, 15], [73, 119, 243], [217, 16, 41], [130, 92, 210], [198, 25, 250], [62, 99, 248], [151, 172, 190], [238, 147, 176], [190, 151, 145], [229, 5, 33], [90, 223, 12], [114, 166, 166], [181, 81, 128], [111, 107, 136], [22, 174, 206], [7, 112, 100], [139, 147, 94], [252, 43, 126], [152, 114, 206], [23, 79, 91], [111, 94, 88], [64, 158, 238], [4, 106, 98], [182, 74, 196], [95, 111, 241], [180, 109, 219], [238, 191, 180], [234, 173, 10], [176, 111, 190], [68, 22, 160], [250, 231, 192], [154, 221, 8], [203, 117, 218], [9, 47, 67], [80, 228, 49], [189, 215, 229], [28, 117, 250], [75, 28, 25], [36, 66, 181], [230, 172, 21], [197, 79, 128], [26, 94, 47], [56, 225, 105], [136, 121, 219], [60, 184, 235], [234, 114, 244], [149, 23, 95], [205, 186, 245], [133, 66, 187], [6, 110, 170], [75, 111, 160], [108, 117, 45], [254, 19, 4], [151, 74, 246], [167, 204, 170], [132, 19, 6], [171, 133, 195], [185, 243, 68], [97, 213, 173], [204, 112, 138], [71, 37, 222], [46, 146, 30], [235, 33, 240], [186, 141, 74], [90, 47, 199], [139, 165, 24], [198, 109, 72], [236, 107, 253], [213, 238, 23], [161, 72, 43], [237, 124, 90], [45, 81, 161], [185, 255, 214], [169, 168, 85], [92, 230, 107], [250, 74, 148], [112, 165, 72], [142, 103, 146], [247, 55, 16], [79, 96, 91], [119, 52, 110], [116, 80, 255], [54, 140, 30], [191, 169, 254], [25, 194, 233], [108, 244, 99], [181, 62, 153], [91, 103, 215], [207, 228, 229], [59, 48, 130], [5, 122, 189], [178, 173, 122], [44, 198, 200], [161, 57, 142], [110, 83, 196], [82, 166, 76], [97, 174, 136], [142, 171, 232], [53, 22, 50], [139, 166, 195], [20, 39, 90], [189, 207, 65], [73, 10, 34], [18, 135, 11], [135, 239, 159], [229, 43, 212], [204, 85, 89], [18, 198, 94], [115, 131, 151], [189, 136, 30], [36, 98, 140], [122, 105, 204], [41, 108, 167], [144, 164, 52], [127, 109, 224], [181, 147, 92], [221, 201, 125], [106, 215, 106], [139, 106, 188], [19, 153, 17], [254, 61, 66], [110, 190, 139], [96, 223, 63], [58, 245, 230], [13, 164, 60], [36, 77, 149], [32, 47, 97], [157, 178, 252], [82, 197, 249], [82, 13, 224], [108, 91, 7], [220, 51, 188], [48, 241, 139], [24, 41, 243], [242, 92, 122], [148, 157, 128], [204, 47, 97], [50, 85, 193], [44, 96, 177], [197, 105, 162], [195, 38, 197], [186, 186, 248], [34, 253, 70], [150, 188, 40], [38, 249, 203], [154, 208, 227], [58, 206, 231], [66, 121, 66], [8, 143, 137], [51, 233, 33], [157, 119, 236], [34, 184, 228], [150, 115, 200], [168, 116, 4], [100, 139, 25], [176, 144, 19], [49, 23, 146], [52, 72, 27], [240, 102, 156], [202, 131, 52], [169, 108, 76], [186, 35, 44], [161, 182, 103], [70, 245, 165], [215, 233, 193], [110, 123, 239], [161, 2, 88], [183, 4, 125], [238, 132, 217], [163, 146, 117], [218, 107, 7], [107, 194, 78], [59, 222, 90], [110, 107, 171], [205, 203, 128], [244, 180, 39], [9, 216, 224], [87, 75, 189], [249, 122, 252], [138, 102, 5], [61, 149, 163], [161, 95, 63], [252, 141, 26], [108, 68, 17], [19, 160, 6], [161, 140, 6], [14, 243, 63], [115, 78, 202], [128, 101, 161], [240, 47, 138], [82, 103, 85], [81, 57, 59], [93, 29, 119], [252, 19, 104], [11, 75, 152], [145, 107, 8], [86, 45, 150], [250, 181, 42], [160, 73, 116], [17, 42, 180], [33, 185, 183], [104, 117, 176], [14, 1, 87], [100, 79, 203], [96, 83, 208], [52, 64, 210], [216, 253, 77], [27, 46, 161], [146, 143, 133], [183, 203, 153], [9, 150, 71], [112, 236, 21], [66, 63, 9], [79, 46, 113], [109, 94, 99], [50, 35, 164], [167, 137, 136], [244, 239, 96], [231, 237, 59], [213, 66, 25], [107, 253, 62], [252, 102, 125], [164, 124, 131], [56, 39, 13], [192, 82, 27], [174, 150, 60], [253, 88, 31], [242, 237, 99], [45, 204, 201], [4, 131, 92], [100, 82, 21], [56, 68, 68], [117, 167, 45], [187, 6, 147], [41, 247, 194], [27, 23, 40], [194, 123, 207], [2, 18, 90], [200, 183, 240], [49, 185, 42], [57, 154, 99], [5, 61, 87], [60, 52, 25], [59, 147, 75], [76, 100, 48], [93, 209, 125], [122, 228, 38], [91, 88, 110], [249, 182, 28], [77, 198, 74], [40, 233, 148], [252, 70, 157], [198, 209, 3], [97, 115, 75], [133, 32, 51], [145, 12, 45], [96, 38, 17], [119, 99, 193], [193, 113, 139], [60, 234, 170], [80, 56, 73], [21, 24, 137], [102, 20, 42], [208, 228, 163], [186, 225, 234], [172, 136, 183], [177, 113, 173], [251, 154, 177], [154, 164, 42], [120, 194, 230], [80, 63, 96], [183, 59, 218], [206, 222, 1], [142, 246, 219], [214, 248, 148], [202, 71, 95], [172, 52, 223], [93, 212, 159], [154, 139, 193], [125, 195, 138], [148, 39, 3], [133, 145, 88], [151, 18, 70], [94, 171, 15], [164, 156, 176], [78, 68, 174], [22, 208, 193], [207, 239, 203], [112, 202, 181], [148, 52, 244], [39, 94, 196], [222, 27, 230], [235, 182, 142], [135, 242, 229], [109, 214, 227], [105, 18, 157], [49, 12, 72], [114, 93, 160], [78, 199, 22], [151, 200, 190], [238, 238, 46], [208, 235, 47], [11, 253, 157], [253, 247, 179], [84, 90, 100], [166, 203, 3], [102, 147, 142], [211, 129, 20], [30, 241, 145], [125, 241, 113], [206, 130, 181], [6, 47, 26], [237, 38, 203], [246, 56, 204], [20, 143, 224], [121, 117, 23], [116, 27, 189], [53, 95, 219], [100, 76, 124], [97, 123, 106], [21, 73, 238], [181, 63, 212], [65, 98, 188], [9, 69, 163], [185, 130, 171], [29, 3, 103], [122, 177, 167], [90, 204, 154], [248, 223, 109], [89, 187, 114], [122, 43, 99], [247, 88, 211], [192, 121, 122], [171, 131, 98], [247, 121, 129], [229, 114, 183], [19, 133, 65], [48, 19, 3], [119, 60, 212], [32, 32, 73], [92, 137, 240], [202, 189, 84], [2, 113, 147], [102, 81, 253], [24, 44, 22], [149, 141, 75], [196, 255, 245], [130, 94, 13], [87, 253, 19], [199, 146, 246], [72, 36, 4], [188, 101, 220], [7, 174, 23], [126, 225, 95], [178, 146, 98], [155, 150, 117], [93, 222, 10], [16, 231, 177], [77, 165, 155], [26, 243, 243], [104, 132, 53], [152, 155, 230], [202, 68, 246], [215, 213, 33], [238, 176, 237], [137, 77, 39], [222, 189, 91], [26, 50, 94], [26, 89, 124], [75, 109, 53], [86, 92, 141], [145, 20, 83], [237, 242, 120], [196, 72, 245], [251, 233, 147], [151, 128, 51], [58, 198, 218], [145, 249, 243], [34, 199, 126], [89, 47, 69], [239, 220, 149], [167, 71, 214], [169, 238, 102], [80, 37, 79], [177, 12, 92], [183, 174, 13], [131, 26, 222], [2, 130, 144], [28, 153, 47], [237, 158, 128], [126, 22, 1], [144, 217, 54], [193, 225, 240], [24, 121, 106], [92, 217, 154], [254, 35, 30], [120, 23, 165], [134, 248, 188], [215, 149, 121], [17, 54, 234], [142, 90, 179], [32, 207, 57], [66, 210, 233], [198, 20, 114], [207, 85, 174], [49, 21, 51], [116, 54, 110], [162, 255, 90], [8, 17, 218], [28, 127, 182], [21, 38, 96], [139, 242, 97], [232, 148, 65], [109, 201, 118], [172, 121, 65], [19, 179, 147], [124, 171, 224], [112, 146, 165], [89, 129, 172], [29, 197, 93], [1, 234, 97], [76, 119, 113], [195, 50, 6], [62, 19, 15], [59, 26, 178], [247, 146, 138], [112, 20, 74], [201, 96, 230], [228, 58, 195], [145, 71, 97], [119, 184, 26], [173, 127, 13], [252, 208, 219], [72, 105, 228], [87, 118, 89], [171, 114, 5], [118, 36, 95], [150, 55, 103], [175, 7, 63], [194, 140, 244], [16, 207, 164], [43, 135, 37], [28, 42, 250], [226, 164, 74], [106, 142, 249], [11, 135, 193], [102, 173, 69], [23, 246, 187], [115, 189, 12], [198, 2, 148], [27, 178, 155], [121, 199, 127], [218, 201, 240], [79, 166, 188], [153, 202, 104], [129, 194, 48], [191, 140, 47], [144, 80, 108], [223, 11, 147], [116, 95, 231], [193, 184, 216], [145, 138, 70], [235, 161, 228], [5, 101, 95], [156, 66, 18], [175, 191, 133], [49, 95, 163], [19, 113, 126], [62, 230, 134], [176, 208, 193], [84, 199, 68], [102, 7, 175], [185, 182, 8], [73, 112, 194], [47, 96, 114], [203, 89, 112], [22, 132, 125], [43, 102, 229], [88, 159, 43], [109, 146, 209], [31, 202, 111], [232, 139, 115], [94, 36, 24], [72, 30, 147], [94, 105, 16], [249, 103, 128], [194, 156, 125], [46, 45, 161], [85, 95, 62], [56, 60, 72], [104, 194, 40], [111, 142, 96], [92, 14, 192], [6, 255, 74], [254, 79, 192], [175, 204, 237], [176, 221, 103], [22, 231, 137], [213, 9, 142], [34, 238, 160], [238, 41, 133], [15, 207, 44], [168, 71, 48], [249, 93, 12], [77, 245, 86], [9, 214, 148], [80, 172, 61], [34, 173, 56], [33, 218, 143], [101, 177, 245], [149, 130, 45], [31, 3, 186], [183, 218, 25], [98, 242, 90], [151, 157, 154], [55, 213, 8], [178, 14, 231], [38, 203, 201], [185, 107, 46], [147, 235, 156], [244, 202, 117], [115, 93, 197], [210, 207, 205], [66, 226, 227], [15, 92, 145], [230, 141, 248], [132, 69, 9], [127, 194, 46], [207, 219, 223], [29, 143, 8], [101, 69, 154], [116, 191, 159], [118, 45, 174], [103, 138, 95], [118, 2, 204], [32, 22, 12], [224, 225, 136], [159, 236, 157], [130, 178, 43], [164, 33, 39], [223, 86, 204], [85, 226, 231], [21, 216, 219], [168, 29, 183], [138, 232, 66], [174, 237, 148], [154, 149, 17], [78, 75, 107], [14, 199, 74], [167, 110, 104], [1, 239, 159], [39, 150, 248], [108, 136, 129], [5, 39, 47], [188, 11, 215], [174, 67, 233], [85, 209, 105], [187, 146, 246], [242, 169, 1], [187, 14, 164], [112, 115, 104], [236, 100, 122], [119, 187, 156], [221, 7, 236], [82, 211, 110], [227, 196, 242], [139, 175, 38], [122, 35, 171], [182, 76, 226], [5, 71, 184], [230, 178, 55], [181, 100, 164], [113, 91, 151], [159, 63, 255], [197, 197, 47], [254, 163, 215], [79, 112, 54], [90, 157, 123], [108, 211, 65], [146, 130, 135], [92, 123, 57], [40, 239, 40], [74, 85, 99], [26, 121, 196], [89, 225, 171], [143, 230, 102], [254, 51, 227], [102, 58, 76], [254, 30, 203], [98, 190, 108], [88, 242, 99], [254, 251, 98], [46, 2, 239], [4, 238, 217], [125, 224, 103], [251, 61, 9], [194, 96, 253], [194, 52, 18], [214, 102, 129], [1, 47, 16], [236, 252, 223], [178, 149, 167], [142, 80, 38], [77, 190, 164], [138, 81, 169], [141, 82, 213], [5, 228, 241], [87, 169, 147], [46, 51, 1], [248, 129, 154], [24, 208, 230], [9, 202, 175], [213, 105, 25], [254, 69, 96], [47, 236, 76], [99, 61, 34], [71, 130, 216], [170, 152, 95], [60, 198, 193], [214, 225, 94], [55, 129, 120], [231, 55, 163], [150, 145, 211], [184, 84, 58], [252, 100, 195], [47, 203, 41], [233, 69, 221], [177, 149, 11], [4, 54, 248], [24, 17, 202], [188, 163, 81], [250, 221, 156], [204, 60, 51], [58, 213, 38], [14, 218, 55], [63, 173, 27], [72, 120, 95], [37, 224, 108], [44, 184, 25], [229, 31, 246], [238, 13, 22], [244, 50, 25], [142, 210, 160], [107, 196, 141], [241, 177, 41], [26, 231, 14], [244, 16, 205], [235, 2, 149], [239, 130, 35], [133, 234, 179], [131, 245, 5], [150, 42, 158], [131, 217, 226], [252, 130, 108], [197, 112, 120], [56, 12, 209], [101, 91, 26], [128, 150, 168], [18, 208, 13], [176, 181, 98], [126, 49, 13], [26, 66, 252], [254, 15, 205], [241, 198, 25], [239, 107, 121], [190, 112, 180], [21, 120, 155], [244, 17, 154], [10, 218, 26], [131, 157, 131], [195, 80, 186], [74, 232, 244], [113, 65, 254], [82, 243, 74], [135, 137, 89], [139, 76, 96], [252, 198, 226], [67, 139, 60], [15, 160, 88], [86, 219, 148], [135, 65, 80], [90, 64, 228], [179, 225, 165], [207, 48, 110], [46, 195, 97], [26, 75, 169], [38, 34, 205], [19, 143, 47], [172, 28, 154], [130, 198, 37], [78, 70, 75], [127, 171, 203], [49, 179, 250], [250, 22, 74], [236, 243, 137], [73, 16, 63], [74, 27, 184], [246, 221, 190], [91, 89, 221], [169, 24, 139], [218, 107, 37], [239, 21, 76], [18, 240, 150], [118, 187, 108], [35, 164, 190], [243, 68, 135], [255, 40, 202], [54, 14, 244], [163, 183, 19], [28, 123, 148], [75, 61, 12], [91, 16, 111], [47, 231, 114], [132, 205, 96], [132, 171, 70], [150, 46, 252], [81, 100, 251], [72, 169, 205], [74, 26, 206], [230, 6, 124], [157, 146, 184], [180, 38, 86], [32, 183, 174], [48, 73, 16], [35, 44, 238], [12, 241, 125], [197, 239, 26], [137, 249, 255], [66, 31, 155], [163, 252, 199], [49, 199, 111], [30, 15, 221], [162, 202, 28], [56, 181, 106], [216, 172, 168], [159, 129, 22], [69, 4, 9], [163, 30, 165], [102, 254, 69], [206, 36, 243], [84, 250, 19], [123, 124, 79], [202, 5, 79], [220, 108, 95], [191, 157, 173], [206, 157, 87], [217, 48, 78], [214, 135, 155], [247, 32, 37], [49, 222, 224], [192, 31, 235], [250, 192, 219], [191, 209, 92], [183, 95, 128], [45, 88, 83], [228, 55, 119], [83, 108, 221], [153, 48, 40], [58, 230, 62], [161, 68, 147], [27, 79, 119], [111, 220, 85], [148, 159, 130], [166, 162, 160], [245, 26, 70], [111, 71, 59], [7, 61, 95], [191, 62, 161], [182, 179, 131], [136, 146, 149], [33, 208, 221], [68, 55, 95], [30, 161, 122], [43, 177, 250], [225, 125, 201], [42, 224, 159], [50, 251, 19], [10, 30, 63], [205, 186, 242], [49, 23, 81], [142, 178, 46], [47, 31, 5], [143, 195, 70], [59, 254, 215], [54, 96, 237], [187, 207, 253], [50, 32, 172], [242, 49, 211], [235, 184, 250], [225, 112, 8], [226, 130, 156], [249, 219, 160], [238, 182, 190], [128, 21, 76], [186, 205, 35], [91, 132, 174], [125, 84, 156], [195, 71, 71], [47, 221, 25], [166, 134, 223], [122, 228, 94], [164, 107, 140], [71, 83, 215], [160, 169, 198], [163, 190, 81], [214, 88, 71], [113, 138, 203], [146, 129, 242], [223, 119, 231], [175, 196, 110], [72, 130, 131], [44, 192, 119], [88, 194, 50], [82, 193, 98], [89, 179, 160], [124, 57, 138], [77, 54, 20], [243, 242, 88], [65, 223, 214], [131, 98, 217], [30, 39, 8], [223, 54, 107], [53, 101, 196], [153, 27, 146], [7, 32, 168], [18, 27, 120], [66, 210, 229], [131, 62, 219], [214, 56, 50], [11, 205, 253], [26, 254, 77], [135, 112, 206], [22, 30, 43], [46, 36, 93], [2, 47, 115], [76, 44, 22], [229, 93, 191], [146, 246, 48], [252, 116, 194], [59, 255, 4], [12, 110, 183], [81, 88, 225], [6, 45, 54], [46, 243, 30], [39, 62, 240], [251, 156, 123], [58, 149, 212], [18, 132, 212], [116, 129, 240], [99, 54, 209], [1, 83, 159], [50, 47, 149], [95, 13, 110], [170, 235, 144], [159, 100, 24], [9, 161, 249], [39, 170, 68], [221, 229, 165], [233, 50, 51], [220, 142, 181], [142, 115, 237], [177, 53, 236], [20, 14, 17], [176, 145, 202], [158, 33, 196], [58, 45, 162], [104, 88, 44], [163, 143, 89], [23, 207, 71], [41, 238, 182], [242, 118, 161], [154, 238, 196], [244, 2, 194], [171, 155, 91], [75, 181, 147], [99, 49, 42], [128, 166, 32], [152, 134, 116], [221, 179, 12], [72, 66, 136], [17, 9, 218], [165, 102, 50], [39, 68, 148], [96, 172, 68], [205, 222, 233], [229, 223, 126], [181, 251, 229], [222, 220, 97], [99, 123, 217], [111, 162, 45], [79, 5, 233], [14, 57, 60], [80, 188, 127], [63, 247, 213], [38, 114, 113], [28, 207, 21], [86, 117, 230], [50, 89, 228], [160, 37, 175], [36, 210, 9], [208, 148, 14], [136, 49, 211], [244, 71, 217], [67, 99, 29], [18, 72, 126], [242, 76, 58], [13, 185, 246], [13, 83, 153], [183, 59, 127], [82, 242, 93], [197, 55, 82], [91, 31, 43], [77, 13, 28], [145, 69, 176], [76, 248, 75], [41, 174, 142], [85, 211, 37], [129, 252, 208], [181, 79, 10], [238, 86, 200], [131, 131, 81], [245, 65, 25], [71, 82, 228], [225, 40, 69], [97, 233, 168], [48, 83, 145], [118, 127, 84], [152, 56, 152], [79, 142, 251], [92, 21, 58], [111, 220, 240], [160, 66, 14], [90, 179, 239], [69, 200, 75], [33, 114, 60], [34, 157, 23], [195, 143, 214], [59, 176, 128], [163, 65, 101], [81, 57, 118], [217, 118, 5], [110, 131, 31], [151, 40, 90], [126, 253, 30], [225, 47, 121], [71, 165, 107], [119, 30, 163], [35, 7, 98], [14, 71, 51], [32, 131, 121], [211, 31, 81], [69, 78, 46], [82, 165, 74], [88, 97, 185], [69, 204, 228], [115, 114, 78], [160, 103, 6], [133, 83, 69], [53, 165, 228], [244, 167, 123], [69, 28, 7], [121, 77, 90], [161, 224, 247], [88, 11, 80], [2, 225, 234], [99, 106, 87], [93, 248, 27], [38, 74, 186], [23, 166, 178], [47, 198, 235]]

#Corresponding classes for PASCAL
VOC_CLASSES = ['background', 'aeroplane', 'bicycle', 'bird', 'boat',
               'bottle', 'bus', 'car', 'cat', 'chair', 'cow',
               'potted plant', 'sheep', 'sofa', 'train', 'tv/monitor',
              'diningtable', 'dog', 'horse', 'motorbike', 'person']

COCO_CLASSES=['background','person','bicycle','motorcycle','airplane','train','truck','boat','horse','sheep','cow','bear','zebra','giraffe','chair','couch','potted plant','bed','toilet','car','bus','bird','cat','dog','elephant','dining table']




def build_colormap2label():
    """Build an RGB color to label mapping for segmentation."""
    colormap2label = np.zeros(256 ** 3)
    for i, colormap in enumerate(VOC_COLORMAP):
        colormap2label[(colormap[0]*256 + colormap[1])*256 + colormap[2]] = i
    return colormap2label

# Function to encode RGB value of pixel to class label
def voc_label_indices(colormap, colormap2label):
    """Map an RGB color to a label."""
    colormap = colormap.astype(np.int32)
    idx = ((colormap[:, :, 0] * 256 + colormap[:, :, 1]) * 256
           + colormap[:, :, 2])
    return colormap2label[idx]
